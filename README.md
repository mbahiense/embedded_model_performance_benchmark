# Project Documentation

This project involves setting up a MongoDB instance using Docker, with custom scripts for benchmarking operations. Below are details about setting up the environment and running benchmarks.

## Prerequisites

- **Docker**: Ensure Docker is installed on your system.
- **MongoDB Community Edition**: The benchmark scripts are configured to interact with `mongodb/mongodb-community-server:7.0.0-ubuntu2204`.

## Getting Started

1. **Clone the Repository** (if applicable):
   ```sh
   git clone <repository-url>
   cd <repository-directory>
   ```

2. **Build Docker Image**:
   ```sh
   docker build -t mongodb-benchmark .
   ```

3. **Run MongoDB Container**:
   ```sh
   docker run -d --name mongodb-container -p 27017:27017 mongodb-benchmark
   ```

4. **Access the Container**:
   You can access the container's shell to inspect files and scripts using:
   ```sh
   docker exec -it mongodb-container /bin/bash
   ```

## Benchmarking Setup

The benchmark scripts are located in the `/scripts` directory of the Docker container. The main script is `benchmark.js`, which you can run from within the container's shell:
```sh
node /scripts/benchmark.js
```

### Script Description

- **Initial setup**: The script initializes a MongoDB database named `pattern_comparison` and loads data based on whether the assets are stored in an attribute pattern or a nested structure.
- **Data creation**: Data is inserted into collections (`assets_attribute` for attribute patterns and `assets_nested` for nested structures) using random values generated by functions like `getNestedSymbols` and `getAttributeSymbols`.
- **Index creation**: Indexes are created on the `assetId` field for both attribute and nested collections, with additional indexes on specific fields to facilitate querying.
- **Query operations**: The script performs queries based on asset IDs and ticker symbols to demonstrate read operations efficiently.
- **Update operations**: Demonstrates update operations using both single and multiple updates based on the type of pattern used.
- **Advanced query**: Implements more complex queries that involve matching elements within nested structures, showcasing how MongoDB can handle such queries effectively.

### Example Outputs

When running the benchmark script, you should see outputs indicating the progress of each operation from data creation to querying and updating records. This includes timings for insert operations, read operations (queries), and write operations (updates).

## Conclusion

This setup provides a comprehensive way to benchmark MongoDB performance with different data structures and query patterns. Adjustments can be made based on specific requirements or environments by modifying the scripts accordingly.
